## 0.18.0 - 08.01.2026

### Highlights
- Complete holiday management system for accurate timebank calculations
- Full CRUD UI for configuring national and company-specific holidays
- Norway holiday preset with automatic Easter calculation
- Comprehensive validation, error handling, and timezone-safe date handling

### Added
- Holiday management UI in Admin > Subscription Settings ([#1325](https://github.com/Puzzlepart/did/pull/1325))
- Full CRUD interface with DataGrid for managing holidays (add, edit, delete)
- Import from country presets (Norway with 13 holidays including movable Easter dates)
- Automatic Easter calculation using Anonymous Gregorian algorithm for movable holidays
- Holiday configuration affects timebank calculations by reducing expected work hours
- Validation for holiday dates (ISO format), names (1-100 chars), and hours (0-8 in 0.25 increments)
- Real-time warnings for duplicate dates, weekend holidays, and leap year issues (Feb 29)
- Support for recurring and non-recurring holidays
- Support for half-day holidays (e.g., New Year's Eve: 4 hours)
- Timezone-safe date handling with ISO date strings (YYYY-MM-DD)
- `HolidayValidationError` class for structured error reporting
- Comprehensive validation functions: `validateHolidayDate()`, `validateHolidayName()`, `validateHoursOff()`
- Easter calculation functions: `calculateEasterSunday()`, `generateMovableHolidays()`
- Helper functions: `isWeekend()`, `findDuplicateHolidays()`, `getWorkingDaysInPeriod()`
- Performance optimizations with `useMemo` in `useWorkWeekStatus` hook
- Comprehensive unit test suite with 50+ test cases covering all scenarios
- Internationalization: Added 25 new holiday-related labels (en-GB, nb, nn)
- Documentation: Complete `HOLIDAY_CONFIGURATION.md` guide (312 lines)

### Changed
- `useWorkWeekStatus` hook now accounts for holidays when calculating timebank
- Enhanced `getHolidayHoursInPeriod()` with error handling, validation, and logging
- Improved `HolidaysField` component with proper TypeScript types (replaced all `any` types)
- Updated subscription settings to include `holidays` configuration section
- Timebank calculations now subtract holiday hours from expected work hours
- Error handling throughout with try-catch blocks and graceful fallbacks

### Fixed
- Fixed type safety issues in holiday configuration (eliminated all `any` types)
- Fixed timezone handling to prevent date shifts across timezones
- Fixed leap year handling for Feb 29 holidays (warns and skips in non-leap years)
- Fixed silent calculation failures with comprehensive error logging
- Fixed missing validation for negative hours, excessive hours, and invalid date formats
- Fixed performance issues with memoization of holiday calculations

### Documentation
- Added comprehensive `HOLIDAY_CONFIGURATION.md` with architecture overview, configuration guide, API reference, and troubleshooting
- Updated `CODE_REVIEW_PR1326.md` with detailed implementation notes and resolution summary
- Added JSDoc comments for all holiday utility functions
- Documented timezone handling strategy and edge cases
- Included best practices and known limitations sections

### Testing
- Created `holidayUtils.test.ts` with 50+ test cases (413 lines)
- Test coverage: validation, timezone handling, Easter calculations, holiday hours calculations, edge cases
- All critical paths tested including cross-year periods, recurring holidays, and error scenarios

### Internal
- Refactored holiday utilities into reusable validation and calculation functions
- Improved error handling with structured error classes
- Enhanced code quality with proper TypeScript interfaces
- Performance optimizations with React hooks memoization
- Separated timezone logic into dedicated helper functions

### Notes
This release introduces a complete holiday management system that ensures accurate timebank calculations during holiday periods. Without holiday configuration, employees working during weeks with national holidays would incorrectly show negative timebank balances. The system supports both fixed holidays (recurring annually) and movable holidays (e.g., Easter-related), with automatic calculation for movable dates. The implementation includes comprehensive validation, error handling, and timezone-safe date operations.

**Example**: Week 52 2025 (Dec 22-28) with 3 Norwegian holidays (Dec 24-26, 24 hours total) now correctly reduces expected hours from 40 to 16, preventing incorrect negative timebank for employees who work only Mon-Tue (16 hours).
