## 0.16.1 - 30.10.2025

### Highlights
  - Dedicated permission for locking/unlocking weeks
  - New "Partner" field on Customer Projects
  - Entra ID user search backed by MongoDB `graph_users` cache and Microsoft Graph delta sync

### Added
  - New `LOCK_UNLOCK_WEEKS` permission (`a7b8c9d0`) protecting the `lockPeriod` mutation.
  - Added "Partner" field to Customer Project to support subcontractor billing workflows ([#1301](https://github.com/Puzzlepart/did/pull/1301)).
  - Introduced Entra ID user search with persisted `graph_users` collection and delta retrieval to keep cached profiles fresh ([#1306](https://github.com/Puzzlepart/did/pull/1306)).
  - Enhanced User Management form with autocomplete search for Entra ID users including automatic loading, performance optimizations, and visual distinction for already-added users ([#1306](https://github.com/Puzzlepart/did/pull/1306)).

### Changed
  - Role permissions for authenticated users are now resolved dynamically per request (no logout required after role updates).
  - Webpack Git metadata integration now auto-disables when `git` or `.git` are unavailable (falling back to environment variables or `unknown`), preventing dev container build failures.
  - Express fallback error response changed from 401 to 404 to reduce noisy Unauthorized logs for missing/static assets.
  - JSON 404 responses returned for API/GraphQL style requests and clients that explicitly accept JSON.
  - Applied employment date filtering to Week Status user queries so inactive users no longer appear in reporting ([#1290](https://github.com/Puzzlepart/did/pull/1290)).
  - Improved User Management UX by removing manual "Load users from Entra ID" button and implementing automatic loading on panel open ([#1306](https://github.com/Puzzlepart/did/pull/1306)).
  - Enhanced autocomplete performance with Set-based O(1) lookups and React memoization for large user datasets ([#1306](https://github.com/Puzzlepart/did/pull/1306)).
  - Added persistent form state management ensuring search checkboxes maintain values across all user interactions ([#1306](https://github.com/Puzzlepart/did/pull/1306)).
  - Hardened manager enrichment service with production-ready error handling, distributed worker coordination, and heartbeat monitoring ([#1306](https://github.com/Puzzlepart/did/pull/1306)).

### Fixed
  - Development watch task crash due to incorrect `concurrently` promise handling (removed `.result` usage; added robust promise resolution).
  - Silent failure to start webpack watcher inside Docker because `.tasks` directory was ignored; adjusted `.dockerignore` to include only `watch.js`.
  - Potential build crash when `git` binary absent (now gracefully skipped).
  - Reduced log noise by suppressing morgan output for 404 static asset requests (hashed bundles / images between rebuilds).
  - Fixed `UserVacation` tooltip ref error by forwarding refs through the `MenuItem` component to the underlying Fluent UI primitive ([#1304](https://github.com/Puzzlepart/did/pull/1304)).
  - Resolved checkbox state persistence issues in User Management form ensuring `includeUsersWithoutGivenName` and `showAlreadyAddedUsers` maintain values during form operations ([#1306](https://github.com/Puzzlepart/did/pull/1306)).
  - Fixed autocomplete disabled item styling and selection behavior for already-added users ([#1306](https://github.com/Puzzlepart/did/pull/1306)).
  - Enhanced manager enrichment service with exponential backoff retry logic, rate limiting protection, and comprehensive error categorization ([#1306](https://github.com/Puzzlepart/did/pull/1306)).

### CI / Chores
  - Added helper npm scripts `docker:watch` and `docker:rebuild:watch` for a canonical rebuild/start workflow without wiping MongoDB volumes.
  - Added diagnostic logging to watch script (explicit process start lines, colored prefixes, failure summaries).
  - Improved resilience of dev build by auto-detecting absence of Git and avoiding unnecessary image bloat.

### Internal
  - Version bump to 0.16.1

### Notes
This release focuses on permission granularity, session freshness and developer experience improvements.