# Docker Compose override for local development
# This file is automatically used by docker-compose to override the main configuration
services:
  did:
    environment:
      # Override these with your actual values for local development
      # Copy this file to docker-compose.override.yml.local and update with your credentials
      - MICROSOFT_CLIENT_ID=${MICROSOFT_CLIENT_ID}
      - MICROSOFT_CLIENT_SECRET=${MICROSOFT_CLIENT_SECRET}
      - MICROSOFT_REDIRECT_URI=${MICROSOFT_REDIRECT_URI:-}
      - MICROSOFT_SCOPES=${MICROSOFT_SCOPES}
      - SESSION_SIGNING_KEY=${SESSION_SIGNING_KEY}
      - SESSION_NAME=${SESSION_NAME}
      - AUTH_PROVIDERS=${AUTH_PROVIDERS}
      - CLIENT_LOG_LEVEL=${CLIENT_LOG_LEVEL}
      - APOLLO_KEY=${APOLLO_KEY}
      - APOLLO_GRAPH_REF=${APOLLO_GRAPH_REF}
      - API_TOKEN_SECRET=${API_TOKEN_SECRET}
      - WEBPACK_NOTIFICATIONS_SOUND=${WEBPACK_NOTIFICATIONS_SOUND}
      - FORK_TS_CHECKER_WEBPACK_PLUGIN_PROFILE=${FORK_TS_CHECKER_WEBPACK_PLUGIN_PROFILE}
      - DISPLAY_VERSION_DETAILS=${DISPLAY_VERSION_DETAILS}
      # Force Docker to use local Redis instead of Azure Redis from .env
      - REDIS_CACHE_HOSTNAME=redis
      - REDIS_CACHE_PORT=6379
      # No Redis auth key needed for local Docker Redis
      - REDIS_CACHE_KEY=
      # Force Docker to use local MongoDB instead of Azure Cosmos from .env
      - MONGO_DB_CONNECTION_STRING=mongodb://mongodb:27017
      - MONGO_DB_DB_NAME=main
      # Enable debug logging for authentication and proxy troubleshooting
      - DEBUG=server/routes/auth,middleware/passport*,server:proxy
    # Mount your local .env file if it exists
    volumes:
      - ./.env:/app/.env:ro